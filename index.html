<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Block Shooter Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  height:100vh;
  background: radial-gradient(circle at top, #0f2a44, #020617);
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:Arial;
}

canvas{
  width:100%;
  max-width:420px;
  height:100%;
  max-height:700px;
  background:#020617;
  border-radius:20px;
  box-shadow:0 0 40px rgba(0,255,255,0.4);
  touch-action:none;
}
</style>
</head>

<body>

<canvas id="game" width="360" height="640"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const shootSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-short-laser-gun-shot-1670.mp3");
const hitSound   = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-arcade-retro-changing-tab-206.wav");

let score = 0;
let bullets = [];
let enemies = [];

let player = {
  x: 165,
  y: 560,
  size: 30,
  targetX: 165
};

let dragging = false;
let autoShoot = false;

// TOUCH CONTROLS (PRO)
canvas.addEventListener("touchstart", e=>{
  dragging = true;
  autoShoot = true;
  shootLoop();
});

canvas.addEventListener("touchend", ()=>{
  dragging = false;
  autoShoot = false;
});

canvas.addEventListener("touchmove", e=>{
  if(!dragging) return;
  const rect = canvas.getBoundingClientRect();
  player.targetX = e.touches[0].clientX - rect.left - player.size/2;
});

// AUTO SHOOT
function shootLoop(){
  if(!autoShoot) return;
  bullets.push({x: player.x + 12, y: player.y});
  shootSound.currentTime = 0;
  shootSound.play();
  setTimeout(shootLoop, 300);
}

// ENEMY SPAWN
setInterval(()=>{
  enemies.push({
    x: Math.random() * 320,
    y: -30,
    size: 30,
    speed: 2.5 + score*0.07
  });
},800);

// GAME LOOP
function update(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // smooth follow
  player.x += (player.targetX - player.x) * 0.15;

  // bounds
  player.x = Math.max(0, Math.min(canvas.width-player.size, player.x));

  // player
  ctx.shadowColor="#00f2ff";
  ctx.shadowBlur=25;
  ctx.fillStyle="#00e5ff";
  ctx.fillRect(player.x, player.y, player.size, player.size);
  ctx.shadowBlur=0;

  // bullets
  bullets.forEach((b,bi)=>{
    b.y -= 7;
    ctx.fillStyle="yellow";
    ctx.fillRect(b.x,b.y,6,14);
    if(b.y<0) bullets.splice(bi,1);
  });

  // enemies
  enemies.forEach((e,ei)=>{
    e.y += e.speed;
    ctx.shadowColor="red";
    ctx.shadowBlur=20;
    ctx.fillStyle="#ff4d6d";
    ctx.fillRect(e.x,e.y,e.size,e.size);
    ctx.shadowBlur=0;

    bullets.forEach((b,bi)=>{
      if(
        b.x < e.x+e.size &&
        b.x+6 > e.x &&
        b.y < e.y+e.size &&
        b.y+14 > e.y
      ){
        enemies.splice(ei,1);
        bullets.splice(bi,1);
        score++;
        hitSound.currentTime=0;
        hitSound.play();
      }
    });

    if(e.y>canvas.height){
      alert("Game Over\nScore: "+score);
      location.reload();
    }
  });

  // UI
  ctx.fillStyle="white";
  ctx.font="20px Arial";
  ctx.fillText("Score: "+score, 15, 30);

  requestAnimationFrame(update);
}

update();
</script>
</body>
  </html>
